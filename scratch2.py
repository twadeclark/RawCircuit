list_of_dicts = []
list_of_dicts.append({"role": "user", "content": "1Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."})
list_of_dicts.append({"role": "user", "content": "2Aliquet bibendum enim facilisis gravida neque. Potenti nullam ac tortor vitae purus faucibus ornare suspendisse. Diam vel quam elementum pulvinar etiam non quam lacus. Sem et tortor consequat id porta nibh venenatis. Commodo sed egestas egestas fringilla. At ultrices mi tempus imperdiet. Praesent tristique magna sit amet purus gravida. Turpis massa sed elementum tempus egestas sed sed risus pretium. Pharetra massa massa ultricies mi quis hendrerit dolor. Nibh venenatis cras sed felis eget velit aliquet. Integer malesuada nunc vel risus commodo viverra maecenas accumsan. Diam maecenas ultricies mi eget mauris pharetra. Dignissim suspendisse in est ante. Netus et malesuada fames ac turpis egestas maecenas pharetra convallis. Vestibulum lorem sed risus ultricies tristique nulla aliquet. Porta non pulvinar neque laoreet. Integer feugiat scelerisque varius morbi. Eu lobortis elementum nibh tellus molestie nunc non blandit. Pretium aenean pharetra magna ac placerat vestibulum. Porttitor leo a diam sollicitudin tempor id eu nisl."})
list_of_dicts.append({"role": "user", "content": "3Scelerisque felis imperdiet proin fermentum. Leo in vitae turpis massa sed. Malesuada proin libero nunc consequat interdum varius sit amet mattis. Scelerisque viverra mauris in aliquam sem fringilla ut. Magnis dis parturient montes nascetur ridiculus mus mauris vitae. Turpis egestas sed tempus urna. Dictum non consectetur a erat nam. Tristique senectus et netus et malesuada fames. Velit sed ullamcorper morbi tincidunt ornare massa eget egestas. Dolor sit amet consectetur adipiscing elit duis tristique sollicitudin. Nunc pulvinar sapien et ligula ullamcorper. Quis vel eros donec ac odio. Eu feugiat pretium nibh ipsum. Et netus et malesuada fames. Integer eget aliquet nibh praesent. Scelerisque eleifend donec pretium vulputate sapien nec. Massa placerat duis ultricies lacus."})
list_of_dicts.append({"role": "user", "content": "4Ut sem nulla pharetra diam sit amet. Potenti nullam ac tortor vitae purus faucibus. Netus et malesuada fames ac turpis egestas maecenas pharetra convallis. Vitae suscipit tellus mauris a diam. Blandit aliquam etiam erat velit. Eget lorem dolor sed viverra ipsum nunc. Semper feugiat nibh sed pulvinar proin gravida. Eget nulla facilisi etiam dignissim diam quis enim lobortis. Sed odio morbi quis commodo. Proin libero nunc consequat interdum varius sit amet mattis. Praesent elementum facilisis leo vel fringilla est ullamcorper eget nulla. Pharetra magna ac placerat vestibulum lectus. Vitae justo eget magna fermentum. Eu sem integer vitae justo eget magna. Ipsum dolor sit amet consectetur adipiscing elit duis tristique. Quis eleifend quam adipiscing vitae proin sagittis nisl. Volutpat diam ut venenatis tellus in. Gravida cum sociis natoque penatibus et magnis dis parturient montes. Duis at consectetur lorem donec massa sapien. Sociis natoque penatibus et magnis dis parturient montes nascetur."})
list_of_dicts.append({"role": "user", "content": "5Ut pharetra sit amet aliquam. Pellentesque dignissim enim sit amet venenatis urna cursus. Dolor sed viverra ipsum nunc. Est ultricies integer quis auctor elit sed vulputate. Tempus egestas sed sed risus pretium quam vulputate dignissim suspendisse. Ipsum a arcu cursus vitae congue mauris rhoncus aenean. Netus et malesuada fames ac turpis egestas. Sem fringilla ut morbi tincidunt augue interdum. Faucibus ornare suspendisse sed nisi lacus. Diam donec adipiscing tristique risus nec feugiat. Tristique senectus et netus et malesuada fames ac turpis egestas. In hac habitasse platea dictumst vestibulum rhoncus est. Quis ipsum suspendisse ultrices gravida. Nisi vitae suscipit tellus mauris a diam maecenas. Est ante in nibh mauris cursus mattis molestie. Venenatis lectus magna fringilla urna porttitor rhoncus dolor. Gravida neque convallis a cras semper. Ut porttitor leo a diam sollicitudin tempor id. Eu lobortis elementum nibh tellus molestie nunc non blandit massa."})
list_of_dicts.append({"role": "user", "content": "6Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."})
list_of_dicts.append({"role": "user", "content": "7Aliquet bibendum enim facilisis gravida neque. Potenti nullam ac tortor vitae purus faucibus ornare suspendisse. Diam vel quam elementum pulvinar etiam non quam lacus. Sem et tortor consequat id porta nibh venenatis. Commodo sed egestas egestas fringilla. At ultrices mi tempus imperdiet. Praesent tristique magna sit amet purus gravida. Turpis massa sed elementum tempus egestas sed sed risus pretium. Pharetra massa massa ultricies mi quis hendrerit dolor. Nibh venenatis cras sed felis eget velit aliquet. Integer malesuada nunc vel risus commodo viverra maecenas accumsan. Diam maecenas ultricies mi eget mauris pharetra. Dignissim suspendisse in est ante. Netus et malesuada fames ac turpis egestas maecenas pharetra convallis. Vestibulum lorem sed risus ultricies tristique nulla aliquet. Porta non pulvinar neque laoreet. Integer feugiat scelerisque varius morbi. Eu lobortis elementum nibh tellus molestie nunc non blandit. Pretium aenean pharetra magna ac placerat vestibulum. Porttitor leo a diam sollicitudin tempor id eu nisl."})
list_of_dicts.append({"role": "user", "content": "8Scelerisque felis imperdiet proin fermentum. Leo in vitae turpis massa sed. Malesuada proin libero nunc consequat interdum varius sit amet mattis. Scelerisque viverra mauris in aliquam sem fringilla ut. Magnis dis parturient montes nascetur ridiculus mus mauris vitae. Turpis egestas sed tempus urna. Dictum non consectetur a erat nam. Tristique senectus et netus et malesuada fames. Velit sed ullamcorper morbi tincidunt ornare massa eget egestas. Dolor sit amet consectetur adipiscing elit duis tristique sollicitudin. Nunc pulvinar sapien et ligula ullamcorper. Quis vel eros donec ac odio. Eu feugiat pretium nibh ipsum. Et netus et malesuada fames. Integer eget aliquet nibh praesent. Scelerisque eleifend donec pretium vulputate sapien nec. Massa placerat duis ultricies lacus."})
list_of_dicts.append({"role": "user", "content": "9Ut sem nulla pharetra diam sit amet. Potenti nullam ac tortor vitae purus faucibus. Netus et malesuada fames ac turpis egestas maecenas pharetra convallis. Vitae suscipit tellus mauris a diam. Blandit aliquam etiam erat velit. Eget lorem dolor sed viverra ipsum nunc. Semper feugiat nibh sed pulvinar proin gravida. Eget nulla facilisi etiam dignissim diam quis enim lobortis. Sed odio morbi quis commodo. Proin libero nunc consequat interdum varius sit amet mattis. Praesent elementum facilisis leo vel fringilla est ullamcorper eget nulla. Pharetra magna ac placerat vestibulum lectus. Vitae justo eget magna fermentum. Eu sem integer vitae justo eget magna. Ipsum dolor sit amet consectetur adipiscing elit duis tristique. Quis eleifend quam adipiscing vitae proin sagittis nisl. Volutpat diam ut venenatis tellus in. Gravida cum sociis natoque penatibus et magnis dis parturient montes. Duis at consectetur lorem donec massa sapien. Sociis natoque penatibus et magnis dis parturient montes nascetur."})
list_of_dicts.append({"role": "user", "content": "10Ut pharetra sit amet aliquam. Pellentesque dignissim enim sit amet venenatis urna cursus. Dolor sed viverra ipsum nunc. Est ultricies integer quis auctor elit sed vulputate. Tempus egestas sed sed risus pretium quam vulputate dignissim suspendisse. Ipsum a arcu cursus vitae congue mauris rhoncus aenean. Netus et malesuada fames ac turpis egestas. Sem fringilla ut morbi tincidunt augue interdum. Faucibus ornare suspendisse sed nisi lacus. Diam donec adipiscing tristique risus nec feugiat. Tristique senectus et netus et malesuada fames ac turpis egestas. In hac habitasse platea dictumst vestibulum rhoncus est. Quis ipsum suspendisse ultrices gravida. Nisi vitae suscipit tellus mauris a diam maecenas. Est ante in nibh mauris cursus mattis molestie. Venenatis lectus magna fringilla urna porttitor rhoncus dolor. Gravida neque convallis a cras semper. Ut porttitor leo a diam sollicitudin tempor id. Eu lobortis elementum nibh tellus molestie nunc non blandit massa."})
list_of_dicts.append({"role": "system", "content": "I'm a chatbot. I'm here to help you."})


# Function to calculate word count
def calculate_word_count(list_of_dicts):
    combined_string = " ".join(item["content"] for item in list_of_dicts)
    return len(combined_string.split())

# Function to reduce content size
def reduce_content(list_of_dicts, word_limit):
    while calculate_word_count(list_of_dicts) > word_limit:
        # Find the longest user content
        longest_user_content = None
        longest_user_index = -1
        for i, item in enumerate(list_of_dicts):
            if item["role"] == "user":
                if longest_user_content is None or len(item["content"].split()) > len(longest_user_content.split()):
                    longest_user_content = item["content"]
                    longest_user_index = i
        
        # Split and reduce the longest content
        if longest_user_content:
            words = longest_user_content.split()
            one_third_length = len(words) // 3
            reduced_content = ' '.join(words[:one_third_length] + words[-one_third_length:])
            list_of_dicts[longest_user_index]["content"] = reduced_content

    return list_of_dicts

def adjust_content_based_on_user_entries(list_of_dicts, word_limit):
    while calculate_word_count(list_of_dicts) > word_limit:
        user_entries = [item for item in list_of_dicts if item["role"] == "user"]
        user_entries_count = len(user_entries)

        # If there are 5 or more "user" entries, remove the middle one
        if user_entries_count >= 5:
            middle_index = len(list_of_dicts) // 2 - 1
            # Ensure the middle_index points to a "user" role entry if the list is not strictly alternating roles
            while list_of_dicts[middle_index]["role"] != "user":
                middle_index += 1  # Adjust index to find the next "user" entry
            del list_of_dicts[middle_index]
        else:
            # If less than 5, proceed with reducing content of the longest "user" entry
            list_of_dicts = reduce_content(list_of_dicts, word_limit)
    
    return list_of_dicts

word_limit = 200
adjusted_list_of_dicts = adjust_content_based_on_user_entries(list_of_dicts, word_limit)

# Recalculate word count
word_count = calculate_word_count(adjusted_list_of_dicts)

# adjusted_list_of_dicts, word_count
print(adjusted_list_of_dicts)
print(word_count)




# from transformers import AutoModelForCausalLM, AutoTokenizer
# import torch


# tokenizer = AutoTokenizer.from_pretrained("microsoft/DialoGPT-medium")
# model = AutoModelForCausalLM.from_pretrained("microsoft/DialoGPT-medium")

# # Let's chat for 5 lines
# for step in range(5):
#     # encode the new user input, add the eos_token and return a tensor in Pytorch
#     new_user_input_ids = tokenizer.encode(input(">> User:") + tokenizer.eos_token, return_tensors='pt')

#     # append the new user input tokens to the chat history
#     bot_input_ids = torch.cat([chat_history_ids, new_user_input_ids], dim=-1) if step > 0 else new_user_input_ids

#     # generated a response while limiting the total chat history to 1000 tokens, 
#     chat_history_ids = model.generate(bot_input_ids, max_length=1000, pad_token_id=tokenizer.eos_token_id)

#     # pretty print last ouput tokens from bot
#     print("DialoGPT: {}".format(tokenizer.decode(chat_history_ids[:, bot_input_ids.shape[-1]:][0], skip_special_tokens=True)))

